"use strict";(self.webpackChunkMyPRJ=self.webpackChunkMyPRJ||[]).push([[630],{8630:(x,p,s)=>{s.r(p),s.d(p,{WelcomeModule:()=>J});var r=s(95),c=s(1721),_=s(6987),m=s(2840),h=s(3649),g=s(1567),t=s(5879),C=s(5842),D=s(855),O=s(1958),z=s(2920),k=s(824);let T=(()=>{class a{constructor(e,n){this.fb=e,this.modalRef=n,this.formGroup=this.fb.group({name:["",[r.kI.required]],cost:[null]})}submitForm(){this.formGroup.valid&&this.modalRef.close(this.formGroup.value)}closeDialog(){this.modalRef.close()}static#t=this.\u0275fac=function(n){return new(n||a)(t.Y36(r.qu),t.Y36(C.Lf))};static#e=this.\u0275cmp=t.Xpm({type:a,selectors:[["app-add-row-dialog"]],decls:16,vars:6,consts:[["nz-form","",3,"formGroup","ngSubmit"],[3,"nzSpan"],["nz-input","","formControlName","name","placeholder","\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435"],["nz-input","","formControlName","cost","type","number","placeholder","\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0446\u0435\u043d\u0443"],["nz-row",""],["nz-button","","nzType","primary",3,"disabled"],["nz-button","","nzType","default",3,"click"]],template:function(n,o){1&n&&(t.TgZ(0,"form",0),t.NdJ("ngSubmit",function(){return o.submitForm()}),t.TgZ(1,"nz-form-item")(2,"nz-form-label",1),t._uU(3,"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435"),t.qZA(),t.TgZ(4,"nz-form-control",1),t._UZ(5,"input",2),t.qZA()(),t.TgZ(6,"nz-form-item")(7,"nz-form-label",1),t._uU(8,"\u0426\u0435\u043d\u0430"),t.qZA(),t.TgZ(9,"nz-form-control",1),t._UZ(10,"input",3),t.qZA()(),t.TgZ(11,"div",4)(12,"button",5),t._uU(13,"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"),t.qZA(),t.TgZ(14,"button",6),t.NdJ("click",function(){return o.closeDialog()}),t._uU(15,"\u041e\u0442\u043c\u0435\u043d\u0430"),t.qZA()()()),2&n&&(t.Q6J("formGroup",o.formGroup),t.xp6(2),t.Q6J("nzSpan",6),t.xp6(2),t.Q6J("nzSpan",18),t.xp6(3),t.Q6J("nzSpan",6),t.xp6(2),t.Q6J("nzSpan",18),t.xp6(3),t.Q6J("disabled",!o.formGroup.valid))},dependencies:[m.ix,D.w,O.dQ,z.t3,z.SK,h.Lr,h.Nx,h.iK,h.Fd,k.Zp,r._Y,r.Fj,r.wV,r.JJ,r.JL,r.sg,r.u],encapsulation:2})}return a})();var w=s(4004);let Z=(()=>{class a{constructor(){}generateUUID(){return(0,w.Z)()}static#t=this.\u0275fac=function(n){return new(n||a)};static#e=this.\u0275prov=t.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"})}return a})(),I=(()=>{class a{constructor(){this.BuyItems=[]}setItems(e){this.BuyItems=e}getItems(){return this.BuyItems}addItem(e){this.BuyItems.push(e)}delItem(e){this.BuyItems.splice(e,1)}editItem(e,n){this.BuyItems[e]=n}static#t=this.\u0275fac=function(n){return new(n||a)};static#e=this.\u0275prov=t.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"})}return a})();var y=s(6814),b=s(2612);function v(a,U){if(1&a){const e=t.EpF();t.TgZ(0,"tr")(1,"td",10)(2,"label",11),t.NdJ("nzCheckedChange",function(o){const l=t.CHM(e).$implicit,d=t.oxw();return t.KtG(d.onItemChecked(l.id,o))}),t.qZA()(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA()()}if(2&a){const e=U.$implicit,n=t.oxw();t.xp6(2),t.Q6J("nzChecked",n.setOfCheckedId.has(e.id))("nzDisabled",e.disabled),t.xp6(2),t.Oqu(e.name),t.xp6(2),t.Oqu(e.cost)}}const S=[{path:"",component:(()=>{class a{constructor(e,n,o,i){this.uuidService=e,this.buyService=n,this.cdr=o,this.modal=i,this.checked=!1,this.firstTime=!0,this.loading=!1,this.indeterminate=!1,this.listOfData=[],this.listOfCurrentPageData=[],this.displayedData=[],this.setOfCheckedId=new Set,this.showCheckedOnly=!1,this.filteredData=[...this.listOfData]}ngOnInit(){}removeCheckedRows(){this.listOfData=this.listOfData.filter(e=>!this.setOfCheckedId.has(e.id)),this.setOfCheckedId.clear(),this.updateFilteredData(),this.refreshCheckedStatus()}updateCheckedSet(e,n){n?this.setOfCheckedId.add(e):this.setOfCheckedId.delete(e)}onCurrentPageDataChange(e){this.displayedData=[...e]}refreshCheckedStatus(){const e=this.listOfData.filter(({disabled:n})=>!n);this.checked=e.length>0&&e.every(({id:n})=>this.setOfCheckedId.has(n)),this.indeterminate=e.some(({id:n})=>this.setOfCheckedId.has(n))&&!this.checked,this.setOfCheckedId.size>0&&this.firstTime&&(this.showCheckedOnly=!0,this.toggleShowCheckedOnly(),this.firstTime=!1)}moveItemUp(){const e=this.listOfData.findIndex(n=>!0===n.selected);e>0?[this.listOfData[e-1],this.listOfData[e]]=[this.listOfData[e],this.listOfData[e-1]]:console.log("\u041d\u0435\u043b\u044c\u0437\u044f \u043f\u0435\u0440\u0435\u043c\u0435\u0441\u0442\u0438\u0442\u044c \u044d\u043b\u0435\u043c\u0435\u043d\u0442 \u2014 \u043e\u043d \u043b\u0438\u0431\u043e \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d, \u043b\u0438\u0431\u043e \u0443\u0436\u0435 \u043f\u0435\u0440\u0432\u044b\u0439 \u0432 \u0441\u043f\u0438\u0441\u043a\u0435."),this.toggleShowCheckedOnly()}moveItemDn(){const e=this.listOfData.findIndex(n=>!0===n.selected);e<this.listOfData.length-1?[this.listOfData[e+1],this.listOfData[e]]=[this.listOfData[e],this.listOfData[e+1]]:console.log("\u041d\u0435\u043b\u044c\u0437\u044f \u043f\u0435\u0440\u0435\u043c\u0435\u0441\u0442\u0438\u0442\u044c \u044d\u043b\u0435\u043c\u0435\u043d\u0442 \u2014 \u043e\u043d \u043b\u0438\u0431\u043e \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d, \u043b\u0438\u0431\u043e \u0443\u0436\u0435 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0438\u0439 \u0432 \u0441\u043f\u0438\u0441\u043a\u0435."),this.toggleShowCheckedOnly()}setSelectedForId(e,n){const o=this.listOfData.find(i=>i.id===e);o?(o.selected=n,this.onItemChecked(e,n)):console.warn(`\u042d\u043b\u0435\u043c\u0435\u043d\u0442 \u0441 id=${e} \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d.`)}onItemChecked(e,n){this.updateCheckedSet(e,n),this.refreshCheckedStatus(),this.updateFilteredData();const o=this.listOfData.find(i=>i.id===e);o&&(o.selected=n)}onAllChecked(e){this.listOfData.forEach(n=>{n.disabled||(this.setOfCheckedId[e?"add":"delete"](n.id),n.selected=e)}),this.refreshCheckedStatus(),this.updateFilteredData()}sendRequest(){this.loading=!0;const e=this.listOfData.filter(n=>this.setOfCheckedId.has(n.id));console.log(e),setTimeout(()=>{this.setOfCheckedId.clear(),this.refreshCheckedStatus(),this.loading=!1},1e3)}trackByFn(e,n){return n.id}onFileSelected(e){const n=e.target;if(n.files&&n.files.length){const o=n.files[0],i=new FileReader;i.onload=l=>{const d=l.target?.result;try{const f=JSON.parse(d);if(!f.listOfData||!Array.isArray(f.listOfData))throw new Error("\u041d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 \u0444\u043e\u0440\u043c\u0430\u0442 JSON");this.listOfData=f.listOfData.map(u=>({id:u.id,name:u.name,cost:u.cost,disabled:!1,selected:u.selected})),this.buyService.setItems(this.listOfData),this.updateFilteredData(),console.log(this.listOfData),this.listOfData.forEach(u=>this.onItemChecked(u.id,u.selected))}catch(f){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u0430\u0440\u0441\u0438\u043d\u0433\u0435 JSON",f)}},i.readAsText(o),this.firstTime=!0}}toggleShowCheckedOnly(){console.log("Before toggle: showCheckedOnly =",this.showCheckedOnly),this.showCheckedOnly=!this.showCheckedOnly,console.log("After toggle: showCheckedOnly =",this.showCheckedOnly),setTimeout(()=>{this.updateFilteredData(),this.showCheckedOnly=!this.showCheckedOnly,this.updateFilteredData()},0)}updateDisplayedData(){this.displayedData=[...this.filteredData]}updateFilteredData(){this.filteredData=this.showCheckedOnly?this.listOfData.filter(e=>this.setOfCheckedId.has(e.id)):[...this.listOfData]}openAddRowDialog(){this.modal.create({nzTitle:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043d\u043e\u0432\u0443\u044e \u0441\u0442\u0440\u043e\u043a\u0443",nzContent:T,nzFooter:null}).afterClose.subscribe(n=>{if(n){const o={id:this.generateUniqueId(),...n,disabled:!1};this.listOfData=[...this.listOfData,o],this.updateFilteredData()}})}generateUniqueId(){return this.listOfData.length>0?Math.max(...this.listOfData.map(e=>e.id))+1:1}downloadFile(){const n=`BuyList-${(new Date).toISOString().replace(/[:.]/g,"-")}.json`,o=JSON.stringify({listOfData:this.listOfData}),i=new Blob([o],{type:"application/json"}),l=window.URL.createObjectURL(i),d=document.createElement("a");d.href=l,d.download=n,document.body.appendChild(d),d.click(),window.URL.revokeObjectURL(l),document.body.removeChild(d)}static#t=this.\u0275fac=function(n){return new(n||a)(t.Y36(Z),t.Y36(I),t.Y36(t.sBO),t.Y36(C.Sf))};static#e=this.\u0275cmp=t.Xpm({type:a,selectors:[["WelcomeComponent"]],decls:28,vars:10,consts:[[1,"send-request"],["type","file",3,"change"],["nz-button","","nzType","primary",3,"click"],["nz-button","","nzType","primary","nzDanger","",3,"click"],["nz-checkbox","",3,"ngModel","ngModelChange"],[1,"table-container"],["nzShowPagination","","nzShowSizeChanger","",1,"full-width-table",3,"nzPageSize","nzPaginationPosition","nzData","nzBordered","nzCurrentPageDataChange"],["rowSelectionTable",""],[3,"nzChecked","nzIndeterminate","nzCheckedChange"],[4,"ngFor","ngForOf","ngForTrackBy"],["align","center"],["nz-checkbox","",3,"nzChecked","nzDisabled","nzCheckedChange"]],template:function(n,o){1&n&&(t.TgZ(0,"div",0)(1,"input",1),t.NdJ("change",function(l){return o.onFileSelected(l)}),t.qZA(),t.TgZ(2,"span"),t._uU(3),t.qZA(),t.TgZ(4,"button",2),t.NdJ("click",function(){return o.openAddRowDialog()}),t._uU(5,"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"),t.qZA(),t.TgZ(6,"button",3),t.NdJ("click",function(){return o.removeCheckedRows()}),t._uU(7,"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"),t.qZA(),t.TgZ(8,"button",2),t.NdJ("click",function(){return o.downloadFile()}),t._uU(9,"\u0417\u0430\u043f\u0438\u0441\u0430\u0442\u044c"),t.qZA(),t.TgZ(10,"button",2),t.NdJ("click",function(){return o.moveItemUp()}),t._uU(11,"^"),t.qZA(),t.TgZ(12,"button",2),t.NdJ("click",function(){return o.moveItemDn()}),t._uU(13,"v"),t.qZA(),t.TgZ(14,"label",4),t.NdJ("ngModelChange",function(l){return o.showCheckedOnly=l})("ngModelChange",function(){return o.toggleShowCheckedOnly()}),t._uU(15," \u0412\u044b\u0434\u0435\u043b\u0435\u043d\u043d\u044b\u0435 "),t.qZA()(),t.TgZ(16,"div",5)(17,"nz-table",6,7),t.NdJ("nzCurrentPageDataChange",function(l){return o.onCurrentPageDataChange(l)}),t.TgZ(19,"thead")(20,"tr")(21,"th",8),t.NdJ("nzCheckedChange",function(l){return o.onAllChecked(l)}),t.qZA(),t.TgZ(22,"th"),t._uU(23,"\u041f\u043e\u043a\u0443\u043f\u043a\u0430"),t.qZA(),t.TgZ(24,"th"),t._uU(25,"\u0426\u0435\u043d\u0430"),t.qZA()()(),t.TgZ(26,"tbody"),t.YNc(27,v,7,4,"tr",9),t.qZA()()()),2&n&&(t.xp6(3),t.hij("\u0412\u044b\u0431\u0440\u0430\u043d\u043e ",o.setOfCheckedId.size,""),t.xp6(11),t.Q6J("ngModel",o.showCheckedOnly),t.xp6(3),t.Q6J("nzPageSize",10)("nzPaginationPosition","both")("nzData",o.filteredData)("nzBordered",!0),t.xp6(4),t.Q6J("nzChecked",o.checked)("nzIndeterminate",o.indeterminate),t.xp6(6),t.Q6J("ngForOf",o.displayedData)("ngForTrackBy",o.trackByFn))},dependencies:[c.N8,c.Uo,c._C,c.Om,c.p0,c.$Z,c.g6,m.ix,D.w,O.dQ,y.sg,b.Ie,r.JJ,r.On],styles:[".send-request[_ngcontent-%COMP%]{margin-bottom:16px}.send-request[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-left:8px}[_nghost-%COMP%]     .ant-table .ant-table-thead>tr>th{background-color:#6acae7!important;padding:2px 4px!important;font-size:11px!important;line-height:14px!important;height:30px!important}  .ant-table-thead>tr>th{background-color:#6acae7!important;font-weight:700!important;text-align:center!important;border-bottom:2px solid #1890ff!important}  .ant-table-pagination{display:flex!important;justify-content:flex-start!important;width:100%}  .ant-pagination{display:flex!important;justify-content:flex-start!important;width:100%}.table-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%}.full-width-table[_ngcontent-%COMP%]{flex:1 1 auto;width:100%}"]})}return a})()}];let A=(()=>{class a{static#t=this.\u0275fac=function(n){return new(n||a)};static#e=this.\u0275mod=t.oAB({type:a});static#n=this.\u0275inj=t.cJS({imports:[g.Bz.forChild(S),g.Bz]})}return a})();var F=s(2962);let J=(()=>{class a{static#t=this.\u0275fac=function(n){return new(n||a)};static#e=this.\u0275mod=t.oAB({type:a});static#n=this.\u0275inj=t.cJS({imports:[c.HQ,_.S,m.sL,A,y.ez,h.U5,k.o7,F.vh,b.Wr,r.u5,r.UX]})}return a})()}}]);