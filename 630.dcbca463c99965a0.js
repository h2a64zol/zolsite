"use strict";(self.webpackChunkMyPRJ=self.webpackChunkMyPRJ||[]).push([[630],{8630:(R,g,i)=>{i.r(g),i.d(g,{WelcomeModule:()=>F});var r=i(95),d=i(1721),T=i(6987),m=i(2840),c=i(3649),C=i(1567),e=i(5879),p=i(5842),z=i(855),k=i(1958),O=i(2920),D=i(824);let b=(()=>{class s{constructor(t,n){this.fb=t,this.modalRef=n,this.formGroup=this.fb.group({name:["",[r.kI.required]],cost:[null,[r.kI.required,r.kI.min(1)]]})}submitForm(){this.formGroup.valid&&this.modalRef.close(this.formGroup.value)}closeDialog(){this.modalRef.close()}static#e=this.\u0275fac=function(n){return new(n||s)(e.Y36(r.qu),e.Y36(p.Lf))};static#t=this.\u0275cmp=e.Xpm({type:s,selectors:[["app-add-row-dialog"]],decls:16,vars:6,consts:[["nz-form","",3,"formGroup","ngSubmit"],[3,"nzSpan"],["nz-input","","formControlName","name","placeholder","\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435"],["nz-input","","formControlName","cost","type","number","placeholder","\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0446\u0435\u043d\u0443"],["nz-row",""],["nz-button","","nzType","primary",3,"disabled"],["nz-button","","nzType","default",3,"click"]],template:function(n,o){1&n&&(e.TgZ(0,"form",0),e.NdJ("ngSubmit",function(){return o.submitForm()}),e.TgZ(1,"nz-form-item")(2,"nz-form-label",1),e._uU(3,"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435"),e.qZA(),e.TgZ(4,"nz-form-control",1),e._UZ(5,"input",2),e.qZA()(),e.TgZ(6,"nz-form-item")(7,"nz-form-label",1),e._uU(8,"\u0426\u0435\u043d\u0430"),e.qZA(),e.TgZ(9,"nz-form-control",1),e._UZ(10,"input",3),e.qZA()(),e.TgZ(11,"div",4)(12,"button",5),e._uU(13,"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"),e.qZA(),e.TgZ(14,"button",6),e.NdJ("click",function(){return o.closeDialog()}),e._uU(15,"\u041e\u0442\u043c\u0435\u043d\u0430"),e.qZA()()()),2&n&&(e.Q6J("formGroup",o.formGroup),e.xp6(2),e.Q6J("nzSpan",6),e.xp6(2),e.Q6J("nzSpan",18),e.xp6(3),e.Q6J("nzSpan",6),e.xp6(2),e.Q6J("nzSpan",18),e.xp6(3),e.Q6J("disabled",!o.formGroup.valid))},dependencies:[m.ix,z.w,k.dQ,O.t3,O.SK,c.Lr,c.Nx,c.iK,c.Fd,D.Zp,r._Y,r.Fj,r.wV,r.JJ,r.JL,r.sg,r.u],encapsulation:2})}return s})();var Z=i(4004);let S=(()=>{class s{constructor(){}generateUUID(){return(0,Z.Z)()}static#e=this.\u0275fac=function(n){return new(n||s)};static#t=this.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"})}return s})(),I=(()=>{class s{constructor(){this.BuyItems=[]}setItems(t){this.BuyItems=t}getItems(){return this.BuyItems}addItem(t){this.BuyItems.push(t)}delItem(t){this.BuyItems.splice(t,1)}editItem(t,n){this.BuyItems[t]=n}static#e=this.\u0275fac=function(n){return new(n||s)};static#t=this.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"})}return s})();var y=i(6814),_=i(2612);function w(s,U){if(1&s){const t=e.EpF();e.TgZ(0,"tr")(1,"td",10)(2,"label",11),e.NdJ("nzCheckedChange",function(o){const l=e.CHM(t).$implicit,f=e.oxw();return e.KtG(f.onItemChecked(l.id,o))}),e.qZA()(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA()()}if(2&s){const t=U.$implicit,n=e.oxw();e.xp6(2),e.Q6J("nzChecked",n.setOfCheckedId.has(t.id))("nzDisabled",t.disabled),e.xp6(2),e.Oqu(t.name),e.xp6(2),e.Oqu(t.cost)}}const v=[{path:"",component:(()=>{class s{constructor(t,n,o,a){this.uuidService=t,this.buyService=n,this.cdr=o,this.modal=a,this.checked=!1,this.loading=!1,this.indeterminate=!1,this.listOfData=[],this.listOfCurrentPageData=[],this.setOfCheckedId=new Set,this.showCheckedOnly=!1,this.filteredData=[...this.listOfData]}ngOnInit(){}removeCheckedRows(){this.listOfData=this.listOfData.filter(t=>!this.setOfCheckedId.has(t.id)),this.setOfCheckedId.clear(),this.updateFilteredData(),this.refreshCheckedStatus()}updateCheckedSet(t,n){n?this.setOfCheckedId.add(t):this.setOfCheckedId.delete(t)}onCurrentPageDataChange(t){this.listOfCurrentPageData=t,this.refreshCheckedStatus()}refreshCheckedStatus(){const t=this.listOfCurrentPageData.filter(({disabled:n})=>!n);this.checked=t.every(({id:n})=>this.setOfCheckedId.has(n)),this.indeterminate=t.some(({id:n})=>this.setOfCheckedId.has(n))&&!this.checked}setSelectedForId(t,n){const o=this.listOfData.find(a=>a.id===t);o?(o.selected=n,this.onItemChecked(t,n)):console.warn(`\u042d\u043b\u0435\u043c\u0435\u043d\u0442 \u0441 id=${t} \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d.`)}onItemChecked(t,n){this.updateCheckedSet(t,n),this.refreshCheckedStatus(),this.updateFilteredData();const o=this.listOfData.find(a=>a.id===t);o&&(o.selected=n)}onAllChecked(t){this.listOfCurrentPageData.filter(({disabled:n})=>!n).forEach(({id:n})=>this.updateCheckedSet(n,t)),this.refreshCheckedStatus()}sendRequest(){this.loading=!0;const t=this.listOfData.filter(n=>this.setOfCheckedId.has(n.id));console.log(t),setTimeout(()=>{this.setOfCheckedId.clear(),this.refreshCheckedStatus(),this.loading=!1},1e3)}trackByFn(t,n){return n.id}onFileSelected(t){const n=t.target;if(n.files&&n.files.length){const o=n.files[0],a=new FileReader;a.onload=l=>{const f=l.target?.result;try{const h=JSON.parse(f);if(!h.listOfData||!Array.isArray(h.listOfData))throw new Error("\u041d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 \u0444\u043e\u0440\u043c\u0430\u0442 JSON");this.listOfData=h.listOfData.map(u=>({id:u.id,name:u.name,cost:u.cost,disabled:!1,selected:u.selected})),this.buyService.setItems(this.listOfData),this.updateFilteredData(),console.log(this.listOfData),this.listOfData.forEach(u=>this.onItemChecked(u.id,u.selected))}catch(h){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u0430\u0440\u0441\u0438\u043d\u0433\u0435 JSON",h)}},a.readAsText(o)}}toggleShowCheckedOnly(){console.log("Before toggle: showCheckedOnly =",this.showCheckedOnly),this.showCheckedOnly=!this.showCheckedOnly,console.log("After toggle: showCheckedOnly =",this.showCheckedOnly),setTimeout(()=>{this.updateFilteredData(),console.log("Simulating second click"),this.showCheckedOnly=!this.showCheckedOnly,this.updateFilteredData()},0)}updateFilteredData(){this.filteredData=this.showCheckedOnly?this.listOfData.filter(t=>this.setOfCheckedId.has(t.id)):[...this.listOfData]}openAddRowDialog(){this.modal.create({nzTitle:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043d\u043e\u0432\u0443\u044e \u0441\u0442\u0440\u043e\u043a\u0443",nzContent:b,nzFooter:null}).afterClose.subscribe(n=>{if(n){const o={id:this.generateUniqueId(),...n,disabled:!1};this.listOfData=[...this.listOfData,o],this.updateFilteredData()}})}generateUniqueId(){return this.listOfData.length>0?Math.max(...this.listOfData.map(t=>t.id))+1:1}downloadFile(){const t=JSON.stringify({listOfData:this.listOfData}),n=new Blob([t],{type:"application/json"}),o=window.URL.createObjectURL(n),a=document.createElement("a");a.href=o,a.download="BuyList.json",document.body.appendChild(a),a.click(),window.URL.revokeObjectURL(o),document.body.removeChild(a)}static#e=this.\u0275fac=function(n){return new(n||s)(e.Y36(S),e.Y36(I),e.Y36(e.sBO),e.Y36(p.Sf))};static#t=this.\u0275cmp=e.Xpm({type:s,selectors:[["WelcomeComponent"]],decls:25,vars:10,consts:[[1,"send-request"],["type","file",3,"change"],["nz-button","","nzType","primary",3,"disabled","nzLoading","click"],["nz-checkbox","",3,"ngModel","ngModelChange"],["nz-button","","nzType","primary",3,"click"],["nz-button","","nzType","primary","nzDanger","",3,"click"],["nzShowPagination","","nzShowSizeChanger","",3,"nzData","nzBordered","nzCurrentPageDataChange"],["rowSelectionTable",""],["nzLabel","Select all",3,"nzChecked","nzIndeterminate","nzCheckedChange"],[4,"ngFor","ngForOf","ngForTrackBy"],["align","center"],["nz-checkbox","",3,"nzChecked","nzDisabled","nzCheckedChange"]],template:function(n,o){1&n&&(e.TgZ(0,"div",0)(1,"input",1),e.NdJ("change",function(l){return o.onFileSelected(l)}),e.qZA(),e.TgZ(2,"button",2),e.NdJ("click",function(){return o.sendRequest()}),e._uU(3," Send Request "),e.qZA(),e.TgZ(4,"span"),e._uU(5),e.qZA(),e.TgZ(6,"label",3),e.NdJ("ngModelChange",function(l){return o.showCheckedOnly=l})("ngModelChange",function(){return o.toggleShowCheckedOnly()}),e._uU(7," Show Checked Only "),e.qZA(),e.TgZ(8,"button",4),e.NdJ("click",function(){return o.openAddRowDialog()}),e._uU(9,"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0441\u0442\u0440\u043e\u043a\u0443"),e.qZA(),e.TgZ(10,"button",5),e.NdJ("click",function(){return o.removeCheckedRows()}),e._uU(11,"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u043f\u043e\u043c\u0435\u0447\u0435\u043d\u043d\u044b\u0435"),e.qZA(),e.TgZ(12,"button",4),e.NdJ("click",function(){return o.downloadFile()}),e._uU(13,"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"),e.qZA()(),e.TgZ(14,"nz-table",6,7),e.NdJ("nzCurrentPageDataChange",function(l){return o.onCurrentPageDataChange(l)}),e.TgZ(16,"thead")(17,"tr")(18,"th",8),e.NdJ("nzCheckedChange",function(l){return o.onAllChecked(l)}),e.qZA(),e.TgZ(19,"th"),e._uU(20,"\u0421\u043d\u0435\u0434\u044c"),e.qZA(),e.TgZ(21,"th"),e._uU(22,"\u0426\u0435\u043d\u0430"),e.qZA()()(),e.TgZ(23,"tbody"),e.YNc(24,w,7,4,"tr",9),e.qZA()()),2&n&&(e.xp6(2),e.Q6J("disabled",0===o.setOfCheckedId.size)("nzLoading",o.loading),e.xp6(3),e.hij("Selected ",o.setOfCheckedId.size," items"),e.xp6(1),e.Q6J("ngModel",o.showCheckedOnly),e.xp6(8),e.Q6J("nzData",o.filteredData)("nzBordered",!0),e.xp6(4),e.Q6J("nzChecked",o.checked)("nzIndeterminate",o.indeterminate),e.xp6(6),e.Q6J("ngForOf",o.filteredData)("ngForTrackBy",o.trackByFn))},dependencies:[d.N8,d.Uo,d._C,d.Om,d.p0,d.$Z,d.g6,m.ix,z.w,k.dQ,y.sg,_.Ie,r.JJ,r.On],styles:[".send-request[_ngcontent-%COMP%]{margin-bottom:16px}.send-request[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-left:8px}"]})}return s})()}];let J=(()=>{class s{static#e=this.\u0275fac=function(n){return new(n||s)};static#t=this.\u0275mod=e.oAB({type:s});static#n=this.\u0275inj=e.cJS({imports:[C.Bz.forChild(v),C.Bz]})}return s})();var A=i(2962);let F=(()=>{class s{static#e=this.\u0275fac=function(n){return new(n||s)};static#t=this.\u0275mod=e.oAB({type:s});static#n=this.\u0275inj=e.cJS({imports:[d.HQ,T.S,m.sL,J,y.ez,c.U5,D.o7,A.vh,_.Wr,r.u5,r.UX]})}return s})()}}]);