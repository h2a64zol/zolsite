"use strict";(self.webpackChunkMyPRJ=self.webpackChunkMyPRJ||[]).push([[630],{8630:(U,g,i)=>{i.r(g),i.d(g,{WelcomeModule:()=>J});var l=i(95),u=i(1721),T=i(6987),m=i(2840),c=i(3649),p=i(1567),t=i(5879),C=i(5842),D=i(855),z=i(1958),O=i(2920),k=i(824);let _=(()=>{class a{constructor(e,n){this.fb=e,this.modalRef=n,this.formGroup=this.fb.group({name:["",[l.kI.required]],cost:[null]})}submitForm(){this.formGroup.valid&&this.modalRef.close(this.formGroup.value)}closeDialog(){this.modalRef.close()}static#t=this.\u0275fac=function(n){return new(n||a)(t.Y36(l.qu),t.Y36(C.Lf))};static#e=this.\u0275cmp=t.Xpm({type:a,selectors:[["app-add-row-dialog"]],decls:16,vars:6,consts:[["nz-form","",3,"formGroup","ngSubmit"],[3,"nzSpan"],["nz-input","","formControlName","name","placeholder","\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435"],["nz-input","","formControlName","cost","type","number","placeholder","\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0446\u0435\u043d\u0443"],["nz-row",""],["nz-button","","nzType","primary",3,"disabled"],["nz-button","","nzType","default",3,"click"]],template:function(n,o){1&n&&(t.TgZ(0,"form",0),t.NdJ("ngSubmit",function(){return o.submitForm()}),t.TgZ(1,"nz-form-item")(2,"nz-form-label",1),t._uU(3,"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435"),t.qZA(),t.TgZ(4,"nz-form-control",1),t._UZ(5,"input",2),t.qZA()(),t.TgZ(6,"nz-form-item")(7,"nz-form-label",1),t._uU(8,"\u0426\u0435\u043d\u0430"),t.qZA(),t.TgZ(9,"nz-form-control",1),t._UZ(10,"input",3),t.qZA()(),t.TgZ(11,"div",4)(12,"button",5),t._uU(13,"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"),t.qZA(),t.TgZ(14,"button",6),t.NdJ("click",function(){return o.closeDialog()}),t._uU(15,"\u041e\u0442\u043c\u0435\u043d\u0430"),t.qZA()()()),2&n&&(t.Q6J("formGroup",o.formGroup),t.xp6(2),t.Q6J("nzSpan",6),t.xp6(2),t.Q6J("nzSpan",18),t.xp6(3),t.Q6J("nzSpan",6),t.xp6(2),t.Q6J("nzSpan",18),t.xp6(3),t.Q6J("disabled",!o.formGroup.valid))},dependencies:[m.ix,D.w,z.dQ,O.t3,O.SK,c.Lr,c.Nx,c.iK,c.Fd,k.Zp,l._Y,l.Fj,l.wV,l.JJ,l.JL,l.sg,l.u],encapsulation:2})}return a})();var Z=i(4004);let w=(()=>{class a{constructor(){}generateUUID(){return(0,Z.Z)()}static#t=this.\u0275fac=function(n){return new(n||a)};static#e=this.\u0275prov=t.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"})}return a})(),I=(()=>{class a{constructor(){this.BuyItems=[]}setItems(e){this.BuyItems=e}getItems(){return this.BuyItems}addItem(e){this.BuyItems.push(e)}delItem(e){this.BuyItems.splice(e,1)}editItem(e,n){this.BuyItems[e]=n}static#t=this.\u0275fac=function(n){return new(n||a)};static#e=this.\u0275prov=t.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"})}return a})();var y=i(6814),b=i(2612);function S(a,B){if(1&a){const e=t.EpF();t.TgZ(0,"tr")(1,"td",9)(2,"label",10),t.NdJ("nzCheckedChange",function(o){const r=t.CHM(e).$implicit,f=t.oxw();return t.KtG(f.onItemChecked(r.id,o))}),t.qZA()(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA()()}if(2&a){const e=B.$implicit,n=t.oxw();t.xp6(2),t.Q6J("nzChecked",n.setOfCheckedId.has(e.id))("nzDisabled",e.disabled),t.xp6(2),t.Oqu(e.name),t.xp6(2),t.Oqu(e.cost)}}const v=[{path:"",component:(()=>{class a{constructor(e,n,o,s){this.uuidService=e,this.buyService=n,this.cdr=o,this.modal=s,this.checked=!1,this.loading=!1,this.indeterminate=!1,this.listOfData=[],this.listOfCurrentPageData=[],this.displayedData=[],this.setOfCheckedId=new Set,this.showCheckedOnly=!1,this.filteredData=[...this.listOfData]}ngOnInit(){}removeCheckedRows(){this.listOfData=this.listOfData.filter(e=>!this.setOfCheckedId.has(e.id)),this.setOfCheckedId.clear(),this.updateFilteredData(),this.refreshCheckedStatus()}updateCheckedSet(e,n){n?this.setOfCheckedId.add(e):this.setOfCheckedId.delete(e)}onCurrentPageDataChange(e){this.displayedData=[...e]}refreshCheckedStatus(){const e=this.listOfData.filter(({disabled:n})=>!n);this.checked=e.length>0&&e.every(({id:n})=>this.setOfCheckedId.has(n)),this.indeterminate=e.some(({id:n})=>this.setOfCheckedId.has(n))&&!this.checked}setSelectedForId(e,n){const o=this.listOfData.find(s=>s.id===e);o?(o.selected=n,this.onItemChecked(e,n)):console.warn(`\u042d\u043b\u0435\u043c\u0435\u043d\u0442 \u0441 id=${e} \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d.`)}onItemChecked(e,n){this.updateCheckedSet(e,n),this.refreshCheckedStatus(),this.updateFilteredData();const o=this.listOfData.find(s=>s.id===e);o&&(o.selected=n)}onAllChecked(e){this.listOfData.forEach(n=>{n.disabled||(this.setOfCheckedId[e?"add":"delete"](n.id),n.selected=e)}),this.refreshCheckedStatus(),this.updateFilteredData()}sendRequest(){this.loading=!0;const e=this.listOfData.filter(n=>this.setOfCheckedId.has(n.id));console.log(e),setTimeout(()=>{this.setOfCheckedId.clear(),this.refreshCheckedStatus(),this.loading=!1},1e3)}trackByFn(e,n){return n.id}onFileSelected(e){const n=e.target;if(n.files&&n.files.length){const o=n.files[0],s=new FileReader;s.onload=r=>{const f=r.target?.result;try{const h=JSON.parse(f);if(!h.listOfData||!Array.isArray(h.listOfData))throw new Error("\u041d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 \u0444\u043e\u0440\u043c\u0430\u0442 JSON");this.listOfData=h.listOfData.map(d=>({id:d.id,name:d.name,cost:d.cost,disabled:!1,selected:d.selected})),this.buyService.setItems(this.listOfData),this.updateFilteredData(),console.log(this.listOfData),this.listOfData.forEach(d=>this.onItemChecked(d.id,d.selected))}catch(h){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u0430\u0440\u0441\u0438\u043d\u0433\u0435 JSON",h)}},s.readAsText(o)}}toggleShowCheckedOnly(){console.log("Before toggle: showCheckedOnly =",this.showCheckedOnly),this.showCheckedOnly=!this.showCheckedOnly,console.log("After toggle: showCheckedOnly =",this.showCheckedOnly),setTimeout(()=>{this.updateFilteredData(),console.log("Simulating second click"),this.showCheckedOnly=!this.showCheckedOnly,this.updateFilteredData()},0)}updateDisplayedData(){this.displayedData=[...this.filteredData]}updateFilteredData(){this.filteredData=this.showCheckedOnly?this.listOfData.filter(e=>this.setOfCheckedId.has(e.id)):[...this.listOfData]}openAddRowDialog(){this.modal.create({nzTitle:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043d\u043e\u0432\u0443\u044e \u0441\u0442\u0440\u043e\u043a\u0443",nzContent:_,nzFooter:null}).afterClose.subscribe(n=>{if(n){const o={id:this.generateUniqueId(),...n,disabled:!1};this.listOfData=[...this.listOfData,o],this.updateFilteredData()}})}generateUniqueId(){return this.listOfData.length>0?Math.max(...this.listOfData.map(e=>e.id))+1:1}downloadFile(){const e=JSON.stringify({listOfData:this.listOfData}),n=new Blob([e],{type:"application/json"}),o=window.URL.createObjectURL(n),s=document.createElement("a");s.href=o,s.download="BuyList.json",document.body.appendChild(s),s.click(),window.URL.revokeObjectURL(o),document.body.removeChild(s)}static#t=this.\u0275fac=function(n){return new(n||a)(t.Y36(w),t.Y36(I),t.Y36(t.sBO),t.Y36(C.Sf))};static#e=this.\u0275cmp=t.Xpm({type:a,selectors:[["WelcomeComponent"]],decls:23,vars:10,consts:[[1,"send-request"],["type","file",3,"change"],["nz-checkbox","",3,"ngModel","ngModelChange"],["nz-button","","nzType","primary",3,"click"],["nz-button","","nzType","primary","nzDanger","",3,"click"],["nzShowPagination","","nzShowSizeChanger","",3,"nzPageSize","nzPaginationPosition","nzData","nzBordered","nzCurrentPageDataChange"],["rowSelectionTable",""],[3,"nzChecked","nzIndeterminate","nzCheckedChange"],[4,"ngFor","ngForOf","ngForTrackBy"],["align","center"],["nz-checkbox","",3,"nzChecked","nzDisabled","nzCheckedChange"]],template:function(n,o){1&n&&(t.TgZ(0,"div",0)(1,"input",1),t.NdJ("change",function(r){return o.onFileSelected(r)}),t.qZA(),t.TgZ(2,"span"),t._uU(3),t.qZA(),t.TgZ(4,"label",2),t.NdJ("ngModelChange",function(r){return o.showCheckedOnly=r})("ngModelChange",function(){return o.toggleShowCheckedOnly()}),t._uU(5," \u0422\u043e\u043b\u044c\u043a\u043e \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u044b\u0435 "),t.qZA(),t.TgZ(6,"button",3),t.NdJ("click",function(){return o.openAddRowDialog()}),t._uU(7,"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0441\u0442\u0440\u043e\u043a\u0443"),t.qZA(),t.TgZ(8,"button",4),t.NdJ("click",function(){return o.removeCheckedRows()}),t._uU(9,"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u043f\u043e\u043c\u0435\u0447\u0435\u043d\u043d\u044b\u0435"),t.qZA(),t.TgZ(10,"button",3),t.NdJ("click",function(){return o.downloadFile()}),t._uU(11,"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"),t.qZA()(),t.TgZ(12,"nz-table",5,6),t.NdJ("nzCurrentPageDataChange",function(r){return o.onCurrentPageDataChange(r)}),t.TgZ(14,"thead")(15,"tr")(16,"th",7),t.NdJ("nzCheckedChange",function(r){return o.onAllChecked(r)}),t.qZA(),t.TgZ(17,"th"),t._uU(18,"\u041f\u043e\u043a\u0443\u043f\u043a\u0430"),t.qZA(),t.TgZ(19,"th"),t._uU(20,"\u0426\u0435\u043d\u0430"),t.qZA()()(),t.TgZ(21,"tbody"),t.YNc(22,S,7,4,"tr",8),t.qZA()()),2&n&&(t.xp6(3),t.hij("\u0412\u044b\u0431\u0440\u0430\u043d\u043e ",o.setOfCheckedId.size," \u043f\u043e\u0437\u0438\u0446\u0438\u0439"),t.xp6(1),t.Q6J("ngModel",o.showCheckedOnly),t.xp6(8),t.Q6J("nzPageSize",10)("nzPaginationPosition","top")("nzData",o.filteredData)("nzBordered",!0),t.xp6(4),t.Q6J("nzChecked",o.checked)("nzIndeterminate",o.indeterminate),t.xp6(6),t.Q6J("ngForOf",o.displayedData)("ngForTrackBy",o.trackByFn))},dependencies:[u.N8,u.Uo,u._C,u.Om,u.p0,u.$Z,u.g6,m.ix,D.w,z.dQ,y.sg,b.Ie,l.JJ,l.On],styles:[".send-request[_ngcontent-%COMP%]{margin-bottom:16px}.send-request[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-left:8px}.ant-pagination[_ngcontent-%COMP%]{display:flex!important}  .ant-table-thead>tr>th{background-color:#6acae7!important;font-weight:700!important;text-align:center!important;border-bottom:2px solid #1890ff!important}"]})}return a})()}];let A=(()=>{class a{static#t=this.\u0275fac=function(n){return new(n||a)};static#e=this.\u0275mod=t.oAB({type:a});static#n=this.\u0275inj=t.cJS({imports:[p.Bz.forChild(v),p.Bz]})}return a})();var F=i(2962);let J=(()=>{class a{static#t=this.\u0275fac=function(n){return new(n||a)};static#e=this.\u0275mod=t.oAB({type:a});static#n=this.\u0275inj=t.cJS({imports:[u.HQ,T.S,m.sL,A,y.ez,c.U5,k.o7,F.vh,b.Wr,l.u5,l.UX]})}return a})()}}]);