"use strict";(self.webpackChunkMyPRJ=self.webpackChunkMyPRJ||[]).push([[630],{8630:(R,g,i)=>{i.r(g),i.d(g,{WelcomeModule:()=>F});var r=i(95),d=i(1721),b=i(6987),m=i(2840),u=i(3649),p=i(1567),e=i(5879),C=i(5842),z=i(855),O=i(1958),k=i(2920),D=i(824);let Z=(()=>{class s{constructor(n,t){this.fb=n,this.modalRef=t,this.formGroup=this.fb.group({name:["",[r.kI.required]],cost:[null,[r.kI.required,r.kI.min(1)]]})}submitForm(){this.formGroup.valid&&this.modalRef.close(this.formGroup.value)}closeDialog(){this.modalRef.close()}static#e=this.\u0275fac=function(t){return new(t||s)(e.Y36(r.qu),e.Y36(C.Lf))};static#t=this.\u0275cmp=e.Xpm({type:s,selectors:[["app-add-row-dialog"]],decls:16,vars:6,consts:[["nz-form","",3,"formGroup","ngSubmit"],[3,"nzSpan"],["nz-input","","formControlName","name","placeholder","\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435"],["nz-input","","formControlName","cost","type","number","placeholder","\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0446\u0435\u043d\u0443"],["nz-row",""],["nz-button","","nzType","primary",3,"disabled"],["nz-button","","nzType","default",3,"click"]],template:function(t,o){1&t&&(e.TgZ(0,"form",0),e.NdJ("ngSubmit",function(){return o.submitForm()}),e.TgZ(1,"nz-form-item")(2,"nz-form-label",1),e._uU(3,"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435"),e.qZA(),e.TgZ(4,"nz-form-control",1),e._UZ(5,"input",2),e.qZA()(),e.TgZ(6,"nz-form-item")(7,"nz-form-label",1),e._uU(8,"\u0426\u0435\u043d\u0430"),e.qZA(),e.TgZ(9,"nz-form-control",1),e._UZ(10,"input",3),e.qZA()(),e.TgZ(11,"div",4)(12,"button",5),e._uU(13,"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"),e.qZA(),e.TgZ(14,"button",6),e.NdJ("click",function(){return o.closeDialog()}),e._uU(15,"\u041e\u0442\u043c\u0435\u043d\u0430"),e.qZA()()()),2&t&&(e.Q6J("formGroup",o.formGroup),e.xp6(2),e.Q6J("nzSpan",6),e.xp6(2),e.Q6J("nzSpan",18),e.xp6(3),e.Q6J("nzSpan",6),e.xp6(2),e.Q6J("nzSpan",18),e.xp6(3),e.Q6J("disabled",!o.formGroup.valid))},dependencies:[m.ix,z.w,O.dQ,k.t3,k.SK,u.Lr,u.Nx,u.iK,u.Fd,D.Zp,r._Y,r.Fj,r.wV,r.JJ,r.JL,r.sg,r.u],encapsulation:2})}return s})();var _=i(4004);let S=(()=>{class s{constructor(){}generateUUID(){return(0,_.Z)()}static#e=this.\u0275fac=function(t){return new(t||s)};static#t=this.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"})}return s})(),I=(()=>{class s{constructor(){this.BuyItems=[]}setItems(n){this.BuyItems=n}getItems(){return this.BuyItems}addItem(n){this.BuyItems.push(n)}delItem(n){this.BuyItems.splice(n,1)}editItem(n,t){this.BuyItems[n]=t}static#e=this.\u0275fac=function(t){return new(t||s)};static#t=this.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"})}return s})();var y=i(6814),T=i(2612);function w(s,U){if(1&s){const n=e.EpF();e.TgZ(0,"tr")(1,"td",9)(2,"label",10),e.NdJ("nzCheckedChange",function(o){const l=e.CHM(n).$implicit,f=e.oxw();return e.KtG(f.onItemChecked(l.id,o))}),e.qZA()(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA()()}if(2&s){const n=U.$implicit,t=e.oxw();e.xp6(2),e.Q6J("nzChecked",t.setOfCheckedId.has(n.id))("nzDisabled",n.disabled),e.xp6(2),e.Oqu(n.name),e.xp6(2),e.Oqu(n.cost)}}const v=[{path:"",component:(()=>{class s{constructor(n,t,o,a){this.uuidService=n,this.buyService=t,this.cdr=o,this.modal=a,this.checked=!1,this.loading=!1,this.indeterminate=!1,this.listOfData=[],this.listOfCurrentPageData=[],this.setOfCheckedId=new Set,this.showCheckedOnly=!1,this.filteredData=[...this.listOfData]}ngOnInit(){}updateCheckedSet(n,t){t?this.setOfCheckedId.add(n):this.setOfCheckedId.delete(n)}onCurrentPageDataChange(n){this.listOfCurrentPageData=n,this.refreshCheckedStatus()}refreshCheckedStatus(){const n=this.listOfCurrentPageData.filter(({disabled:t})=>!t);this.checked=n.every(({id:t})=>this.setOfCheckedId.has(t)),this.indeterminate=n.some(({id:t})=>this.setOfCheckedId.has(t))&&!this.checked}setSelectedForId(n,t){const o=this.listOfData.find(a=>a.id===n);o?(o.selected=t,this.onItemChecked(n,t)):console.warn(`\u042d\u043b\u0435\u043c\u0435\u043d\u0442 \u0441 id=${n} \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d.`)}onItemChecked(n,t){this.updateCheckedSet(n,t),this.refreshCheckedStatus(),this.updateFilteredData();const o=this.listOfData.find(a=>a.id===n);o&&(o.selected=t)}onAllChecked(n){this.listOfCurrentPageData.filter(({disabled:t})=>!t).forEach(({id:t})=>this.updateCheckedSet(t,n)),this.refreshCheckedStatus()}sendRequest(){this.loading=!0;const n=this.listOfData.filter(t=>this.setOfCheckedId.has(t.id));console.log(n),setTimeout(()=>{this.setOfCheckedId.clear(),this.refreshCheckedStatus(),this.loading=!1},1e3)}trackByFn(n,t){return t.id}onFileSelected(n){const t=n.target;if(t.files&&t.files.length){const o=t.files[0],a=new FileReader;a.onload=l=>{const f=l.target?.result;try{const h=JSON.parse(f);if(!h.listOfData||!Array.isArray(h.listOfData))throw new Error("\u041d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 \u0444\u043e\u0440\u043c\u0430\u0442 JSON");this.listOfData=h.listOfData.map(c=>({id:c.id,name:c.name,cost:c.cost,disabled:!1,selected:c.selected})),this.buyService.setItems(this.listOfData),this.updateFilteredData(),console.log(this.listOfData),this.listOfData.forEach(c=>this.onItemChecked(c.id,c.selected))}catch(h){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u0430\u0440\u0441\u0438\u043d\u0433\u0435 JSON",h)}},a.readAsText(o)}}toggleShowCheckedOnly(){console.log("Before toggle: showCheckedOnly =",this.showCheckedOnly),this.showCheckedOnly=!this.showCheckedOnly,console.log("After toggle: showCheckedOnly =",this.showCheckedOnly),setTimeout(()=>{this.updateFilteredData(),console.log("Simulating second click"),this.showCheckedOnly=!this.showCheckedOnly,this.updateFilteredData()},0)}updateFilteredData(){this.filteredData=this.showCheckedOnly?this.listOfData.filter(n=>this.setOfCheckedId.has(n.id)):[...this.listOfData]}openAddRowDialog(){this.modal.create({nzTitle:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043d\u043e\u0432\u0443\u044e \u0441\u0442\u0440\u043e\u043a\u0443",nzContent:Z,nzFooter:null}).afterClose.subscribe(t=>{if(t){const o={id:this.generateUniqueId(),...t,disabled:!1};this.listOfData=[...this.listOfData,o],this.updateFilteredData()}})}generateUniqueId(){return this.listOfData.length>0?Math.max(...this.listOfData.map(n=>n.id))+1:1}downloadFile(){const n=JSON.stringify({listOfData:this.listOfData}),t=new Blob([n],{type:"application/json"}),o=window.URL.createObjectURL(t),a=document.createElement("a");a.href=o,a.download="BuyList.json",document.body.appendChild(a),a.click(),window.URL.revokeObjectURL(o),document.body.removeChild(a)}static#e=this.\u0275fac=function(t){return new(t||s)(e.Y36(S),e.Y36(I),e.Y36(e.sBO),e.Y36(C.Sf))};static#t=this.\u0275cmp=e.Xpm({type:s,selectors:[["WelcomeComponent"]],decls:23,vars:10,consts:[[1,"send-request"],["type","file",3,"change"],["nz-button","","nzType","primary",3,"disabled","nzLoading","click"],["nz-checkbox","",3,"ngModel","ngModelChange"],["nz-button","","nzType","primary",3,"click"],["nzShowPagination","","nzShowSizeChanger","",3,"nzData","nzBordered","nzCurrentPageDataChange"],["rowSelectionTable",""],["nzLabel","Select all",3,"nzChecked","nzIndeterminate","nzCheckedChange"],[4,"ngFor","ngForOf","ngForTrackBy"],["align","center"],["nz-checkbox","",3,"nzChecked","nzDisabled","nzCheckedChange"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"input",1),e.NdJ("change",function(l){return o.onFileSelected(l)}),e.qZA(),e.TgZ(2,"button",2),e.NdJ("click",function(){return o.sendRequest()}),e._uU(3," Send Request "),e.qZA(),e.TgZ(4,"span"),e._uU(5),e.qZA(),e.TgZ(6,"label",3),e.NdJ("ngModelChange",function(l){return o.showCheckedOnly=l})("ngModelChange",function(){return o.toggleShowCheckedOnly()}),e._uU(7," Show Checked Only "),e.qZA(),e.TgZ(8,"button",4),e.NdJ("click",function(){return o.openAddRowDialog()}),e._uU(9,"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0441\u0442\u0440\u043e\u043a\u0443"),e.qZA(),e.TgZ(10,"button",4),e.NdJ("click",function(){return o.downloadFile()}),e._uU(11,"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"),e.qZA()(),e.TgZ(12,"nz-table",5,6),e.NdJ("nzCurrentPageDataChange",function(l){return o.onCurrentPageDataChange(l)}),e.TgZ(14,"thead")(15,"tr")(16,"th",7),e.NdJ("nzCheckedChange",function(l){return o.onAllChecked(l)}),e.qZA(),e.TgZ(17,"th"),e._uU(18,"\u0421\u043d\u0435\u0434\u044c"),e.qZA(),e.TgZ(19,"th"),e._uU(20,"\u0426\u0435\u043d\u0430"),e.qZA()()(),e.TgZ(21,"tbody"),e.YNc(22,w,7,4,"tr",8),e.qZA()()),2&t&&(e.xp6(2),e.Q6J("disabled",0===o.setOfCheckedId.size)("nzLoading",o.loading),e.xp6(3),e.hij("Selected ",o.setOfCheckedId.size," items"),e.xp6(1),e.Q6J("ngModel",o.showCheckedOnly),e.xp6(6),e.Q6J("nzData",o.filteredData)("nzBordered",!0),e.xp6(4),e.Q6J("nzChecked",o.checked)("nzIndeterminate",o.indeterminate),e.xp6(6),e.Q6J("ngForOf",o.filteredData)("ngForTrackBy",o.trackByFn))},dependencies:[d.N8,d.Uo,d._C,d.Om,d.p0,d.$Z,d.g6,m.ix,z.w,O.dQ,y.sg,T.Ie,r.JJ,r.On],styles:[".send-request[_ngcontent-%COMP%]{margin-bottom:16px}.send-request[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-left:8px}"]})}return s})()}];let J=(()=>{class s{static#e=this.\u0275fac=function(t){return new(t||s)};static#t=this.\u0275mod=e.oAB({type:s});static#n=this.\u0275inj=e.cJS({imports:[p.Bz.forChild(v),p.Bz]})}return s})();var A=i(2962);let F=(()=>{class s{static#e=this.\u0275fac=function(t){return new(t||s)};static#t=this.\u0275mod=e.oAB({type:s});static#n=this.\u0275inj=e.cJS({imports:[d.HQ,b.S,m.sL,J,y.ez,u.U5,D.o7,A.vh,T.Wr,r.u5,r.UX]})}return s})()}}]);